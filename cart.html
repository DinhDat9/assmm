<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Gi·ªè h√†ng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h3>üõí Gi·ªè h√†ng c·ªßa b·∫°n</h3>
    <ul id="cart-items" class="list-group mb-3"></ul>
    <h5 id="total-amount" class="mb-3"></h5>
    <button id="checkout-btn" class="btn btn-success">Thanh to√°n</button>
    <div id="bill" class="mt-5"></div>
  </div>

  <script>
    // L·∫•y gi·ªè h√†ng t·ª´ localStorage
    let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    const cartList = document.getElementById('cart-items');
    const totalAmount = document.getElementById('total-amount');
    const checkoutBtn = document.getElementById('checkout-btn');
    const billDiv = document.getElementById('bill');

    // Hi·ªÉn th·ªã gi·ªè h√†ng
    function renderCart() {
      cartList.innerHTML = '';
      let total = 0;
      if (cartItems.length === 0) {
        cartList.innerHTML = "<li class='list-group-item'>Gi·ªè h√†ng tr·ªëng</li>";
        totalAmount.innerText = '';
        checkoutBtn.disabled = true;
      } else {
        cartItems.forEach(item => {
          const li = document.createElement('li');
          li.className = 'list-group-item d-flex justify-content-between align-items-center';
          li.innerText = `${item.name}`;
          const span = document.createElement('span');
          span.className = 'badge bg-primary rounded-pill';
          span.innerText = item.price;
          li.appendChild(span);
          cartList.appendChild(li);

          // Chuy·ªÉn gi√° ti·ªÅn th√†nh s·ªë (lo·∫°i b·ªè VND v√† d·∫•u ,)
          const number = Number(item.price.replace(/[^\d]/g, ''));
          total += number;
        });
        totalAmount.innerText = `T·ªïng c·ªông: ${total.toLocaleString()} VND`;
        checkoutBtn.disabled = false;
      }
    }

    renderCart();

    // X·ª≠ l√Ω n√∫t Thanh to√°n
    checkoutBtn.addEventListener('click', function() {
      if (cartItems.length === 0) return;

      // In h√≥a ƒë∆°n
      let billHTML = `<h4>üßæ H√≥a ƒë∆°n thanh to√°n</h4>`;
      billHTML += `<table class="table table-bordered">
                    <thead><tr><th>S·∫£n ph·∫©m</th><th>Gi√°</th></tr></thead>
                    <tbody>`;
      cartItems.forEach(item => {
        billHTML += `<tr><td>${item.name}</td><td>${item.price}</td></tr>`;
      });
      const total = cartItems.reduce((sum, item) => {
        return sum + Number(item.price.replace(/[^\d]/g, ''));
      }, 0);
      billHTML += `</tbody><tfoot><tr><th>T·ªïng c·ªông</th><th>${total.toLocaleString()} VND</th></tr></tfoot></table>`;
      billHTML += `<p class="text-success">‚úÖ Thanh to√°n th√†nh c√¥ng! C·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng.</p>`;

      billDiv.innerHTML = billHTML;

      // X√≥a gi·ªè h√†ng
      localStorage.removeItem('cart');
      cartItems = [];
      renderCart();
    });
  </script>
</body>
</html>
